import numpy as np
import dashscope
from dashscope import TextEmbedding
from dashscope.api_entities.dashscope_response import DashScopeAPIResponse
import logging
import csv

# 配置日志记录
logging.basicConfig(level=logging.INFO)
dashscope.api_key = 'sk-83a484c55806469ab2fcb26edff358c9'


def process_long_text(text, max_length=5000):
    """处理超长文本的分块策略"""
    # 这里添加适合您业务的分块逻辑
    return [text[i:i + max_length] for i in range(0, len(text), max_length)]


def safe_embedding(text_chunks):
    """带有多重安全验证的嵌入函数"""
    try:
        resp = TextEmbedding.call(
            model="text-embedding-v1",
            input=text_chunks
        )

        # 层级式响应验证
        if not isinstance(resp, DashScopeAPIResponse):
            raise ValueError("Invalid API response type")

        if not hasattr(resp, 'output') or not resp.output:
            raise ValueError("Empty API response output")

        embeddings = resp.output.get('embeddings')
        if not isinstance(embeddings, list) or len(embeddings) == 0:
            raise ValueError("Invalid embeddings format")

        # 合并分块结果
        all_embeddings = []
        for emb in embeddings:
            if isinstance(emb.get('embedding'), list):
                all_embeddings.extend(emb['embedding'])
        return np.array(all_embeddings)

    except Exception as e:
        logging.error(f"Embedding Error: {str(e)}")
        return None


def reshape_with_fallback(raw_vector, target_shape=(2, 2, 256)):
    """智能维度转换"""
    target_size = np.prod(target_shape)

    if len(raw_vector) < target_size:
        # 使用反射模式扩展向量
        repeat_times = (target_size // len(raw_vector)) + 1
        expanded = np.tile(raw_vector, repeat_times)[:target_size]
    elif len(raw_vector) > target_size:
        # 智能截断保留重要特征
        expanded = raw_vector[:target_size]
    else:
        expanded = raw_vector

    return expanded.reshape(target_shape)


def text_to_vector(text):
    # 处理超长文本
    chunks = process_long_text(text)

    # 获取嵌入结果
    raw_vector = safe_embedding(chunks)

    if raw_vector is None:
        # 应急处理：生成随机向量
        logging.warning("Using fallback random vector")
        raw_vector = np.random.rand(1024)

    # 维度转换
    return reshape_with_fallback(raw_vector)

title = "ID,Date,VOLUME_ET,VOLUME_NET,VOLUME_ED,VOLUME_TC,VOLUME_WT,VOLUME_BRAIN,VOLUME_ET_OVER_NET,VOLUME_ET_OVER_ED,VOLUME_NET_OVER_ED,VOLUME_ET_over_TC,VOLUME_NET_over_TC,VOLUME_ED_over_TC,VOLUME_ET_OVER_WT,VOLUME_NET_OVER_WT,VOLUME_ED_OVER_WT,VOLUME_TC_OVER_WT,VOLUME_ET_OVER_BRAIN,VOLUME_NET_OVER_BRAIN,VOLUME_ED_over_BRAIN,VOLUME_TC_over_BRAIN,VOLUME_WT_OVER_BRAIN,DIST_Vent_TC,DIST_Vent_ED,INTENSITY_Mean_ET_T1Gd,INTENSITY_STD_ET_T1Gd,INTENSITY_Mean_ET_T1,INTENSITY_STD_ET_T1,INTENSITY_Mean_ET_T2,INTENSITY_STD_ET_T2,INTENSITY_Mean_ET_FLAIR,INTENSITY_STD_ET_FLAIR,INTENSITY_Mean_NET_T1Gd,INTENSITY_STD_NET_T1Gd,INTENSITY_Mean_NET_T1,INTENSITY_STD_NET_T1,INTENSITY_Mean_NET_T2,INTENSITY_STD_NET_T2,INTENSITY_Mean_NET_FLAIR,INTENSITY_STD_NET_FLAIR,INTENSITY_Mean_ED_T1Gd,INTENSITY_STD_ED_T1Gd,INTENSITY_Mean_ED_T1,INTENSITY_STD_ED_T1,INTENSITY_Mean_ED_T2,INTENSITY_STD_ED_T2,INTENSITY_Mean_ED_FLAIR,INTENSITY_STD_ED_FLAIR,HISTO_ET_T1Gd_Bin1,HISTO_ET_T1Gd_Bin2,HISTO_ET_T1Gd_Bin3,HISTO_ET_T1Gd_Bin4,HISTO_ET_T1Gd_Bin5,HISTO_ET_T1Gd_Bin6,HISTO_ET_T1Gd_Bin7,HISTO_ET_T1Gd_Bin8,HISTO_ET_T1Gd_Bin9,HISTO_ET_T1Gd_Bin10,HISTO_ED_T1Gd_Bin1,HISTO_ED_T1Gd_Bin2,HISTO_ED_T1Gd_Bin3,HISTO_ED_T1Gd_Bin4,HISTO_ED_T1Gd_Bin5,HISTO_ED_T1Gd_Bin6,HISTO_ED_T1Gd_Bin7,HISTO_ED_T1Gd_Bin8,HISTO_ED_T1Gd_Bin9,HISTO_ED_T1Gd_Bin10,HISTO_NET_T1Gd_Bin1,HISTO_NET_T1Gd_Bin2,HISTO_NET_T1Gd_Bin3,HISTO_NET_T1Gd_Bin4,HISTO_NET_T1Gd_Bin5,HISTO_NET_T1Gd_Bin6,HISTO_NET_T1Gd_Bin7,HISTO_NET_T1Gd_Bin8,HISTO_NET_T1Gd_Bin9,HISTO_NET_T1Gd_Bin10,HISTO_ET_T1_Bin1,HISTO_ET_T1_Bin2,HISTO_ET_T1_Bin3,HISTO_ET_T1_Bin4,HISTO_ET_T1_Bin5,HISTO_ET_T1_Bin6,HISTO_ET_T1_Bin7,HISTO_ET_T1_Bin8,HISTO_ET_T1_Bin9,HISTO_ET_T1_Bin10,HISTO_ED_T1_Bin1,HISTO_ED_T1_Bin2,HISTO_ED_T1_Bin3,HISTO_ED_T1_Bin4,HISTO_ED_T1_Bin5,HISTO_ED_T1_Bin6,HISTO_ED_T1_Bin7,HISTO_ED_T1_Bin8,HISTO_ED_T1_Bin9,HISTO_ED_T1_Bin10,HISTO_NET_T1_Bin1,HISTO_NET_T1_Bin2,HISTO_NET_T1_Bin3,HISTO_NET_T1_Bin4,HISTO_NET_T1_Bin5,HISTO_NET_T1_Bin6,HISTO_NET_T1_Bin7,HISTO_NET_T1_Bin8,HISTO_NET_T1_Bin9,HISTO_NET_T1_Bin10,HISTO_ET_T2_Bin1,HISTO_ET_T2_Bin2,HISTO_ET_T2_Bin3,HISTO_ET_T2_Bin4,HISTO_ET_T2_Bin5,HISTO_ET_T2_Bin6,HISTO_ET_T2_Bin7,HISTO_ET_T2_Bin8,HISTO_ET_T2_Bin9,HISTO_ET_T2_Bin10,HISTO_ED_T2_Bin1,HISTO_ED_T2_Bin2,HISTO_ED_T2_Bin3,HISTO_ED_T2_Bin4,HISTO_ED_T2_Bin5,HISTO_ED_T2_Bin6,HISTO_ED_T2_Bin7,HISTO_ED_T2_Bin8,HISTO_ED_T2_Bin9,HISTO_ED_T2_Bin10,HISTO_NET_T2_Bin1,HISTO_NET_T2_Bin2,HISTO_NET_T2_Bin3,HISTO_NET_T2_Bin4,HISTO_NET_T2_Bin5,HISTO_NET_T2_Bin6,HISTO_NET_T2_Bin7,HISTO_NET_T2_Bin8,HISTO_NET_T2_Bin9,HISTO_NET_T2_Bin10,HISTO_ET_FLAIR_Bin1,HISTO_ET_FLAIR_Bin2,HISTO_ET_FLAIR_Bin3,HISTO_ET_FLAIR_Bin4,HISTO_ET_FLAIR_Bin5,HISTO_ET_FLAIR_Bin6,HISTO_ET_FLAIR_Bin7,HISTO_ET_FLAIR_Bin8,HISTO_ET_FLAIR_Bin9,HISTO_ET_FLAIR_Bin10,HISTO_ED_FLAIR_Bin1,HISTO_ED_FLAIR_Bin2,HISTO_ED_FLAIR_Bin3,HISTO_ED_FLAIR_Bin4,HISTO_ED_FLAIR_Bin5,HISTO_ED_FLAIR_Bin6,HISTO_ED_FLAIR_Bin7,HISTO_ED_FLAIR_Bin8,HISTO_ED_FLAIR_Bin9,HISTO_ED_FLAIR_Bin10,HISTO_NET_FLAIR_Bin1,HISTO_NET_FLAIR_Bin2,HISTO_NET_FLAIR_Bin3,HISTO_NET_FLAIR_Bin4,HISTO_NET_FLAIR_Bin5,HISTO_NET_FLAIR_Bin6,HISTO_NET_FLAIR_Bin7,HISTO_NET_FLAIR_Bin8,HISTO_NET_FLAIR_Bin9,HISTO_NET_FLAIR_Bin10,SPATIAL_Frontal,SPATIAL_Temporal,SPATIAL_Parietal,SPATIAL_Basal_G,SPATIAL_Insula,SPATIAL_CC_Fornix,SPATIAL_Occipital,SPATIAL_Cere,SPATIAL_Brain_stem,ECCENTRICITY_ET,ECCENTRICITY_ED,ECCENTRICITY_NET,SOLIDITY_ET,SOLIDITY_ED,SOLIDITY_NET,TEXTURE_GLOBAL_ET_T1Gd_Variance,TEXTURE_GLOBAL_ET_T1Gd_Skewness,TEXTURE_GLOBAL_ET_T1Gd_Kurtosis,TEXTURE_GLOBAL_ET_T1_Variance,TEXTURE_GLOBAL_ET_T1_Skewness,TEXTURE_GLOBAL_ET_T1_Kurtosis,TEXTURE_GLOBAL_ET_T2_Variance,TEXTURE_GLOBAL_ET_T2_Skewness,TEXTURE_GLOBAL_ET_T2_Kurtosis,TEXTURE_GLOBAL_ET_FLAIR_Variance,TEXTURE_GLOBAL_ET_FLAIR_Skewness,TEXTURE_GLOBAL_ET_FLAIR_Kurtosis,TEXTURE_GLOBAL_ED_T1Gd_Variance,TEXTURE_GLOBAL_ED_T1Gd_Skewness,TEXTURE_GLOBAL_ED_T1Gd_Kurtosis,TEXTURE_GLOBAL_ED_T1_Variance,TEXTURE_GLOBAL_ED_T1_Skewness,TEXTURE_GLOBAL_ED_T1_Kurtosis,TEXTURE_GLOBAL_ED_T2_Variance,TEXTURE_GLOBAL_ED_T2_Skewness,TEXTURE_GLOBAL_ED_T2_Kurtosis,TEXTURE_GLOBAL_ED_FLAIR_Variance,TEXTURE_GLOBAL_ED_FLAIR_Skewness,TEXTURE_GLOBAL_ED_FLAIR_Kurtosis,TEXTURE_GLOBAL_NET_T1Gd_Variance,TEXTURE_GLOBAL_NET_T1Gd_Skewness,TEXTURE_GLOBAL_NET_T1Gd_Kurtosis,TEXTURE_GLOBAL_NET_T1_Variance,TEXTURE_GLOBAL_NET_T1_Skewness,TEXTURE_GLOBAL_NET_T1_Kurtosis,TEXTURE_GLOBAL_NET_T2_Variance,TEXTURE_GLOBAL_NET_T2_Skewness,TEXTURE_GLOBAL_NET_T2_Kurtosis,TEXTURE_GLOBAL_NET_FLAIR_Variance,TEXTURE_GLOBAL_NET_FLAIR_Skewness,TEXTURE_GLOBAL_NET_FLAIR_Kurtosis,TEXTURE_GLCM_ET_T1Gd_Energy,TEXTURE_GLCM_ET_T1Gd_Contrast,TEXTURE_GLCM_ET_T1Gd_Entropy,TEXTURE_GLCM_ET_T1Gd_Homogeneity,TEXTURE_GLCM_ET_T1Gd_Correlation,TEXTURE_GLCM_ET_T1Gd_SumAverage,TEXTURE_GLCM_ET_T1Gd_Variance,TEXTURE_GLCM_ET_T1Gd_Dissimilarity,TEXTURE_GLCM_ET_T1Gd_AutoCorrelation,TEXTURE_GLCM_ET_T1_Energy,TEXTURE_GLCM_ET_T1_Contrast,TEXTURE_GLCM_ET_T1_Entropy,TEXTURE_GLCM_ET_T1_Homogeneity,TEXTURE_GLCM_ET_T1_Correlation,TEXTURE_GLCM_ET_T1_SumAverage,TEXTURE_GLCM_ET_T1_Variance,TEXTURE_GLCM_ET_T1_Dissimilarity,TEXTURE_GLCM_ET_T1_AutoCorrelation,TEXTURE_GLCM_ET_T2_Energy,TEXTURE_GLCM_ET_T2_Contrast,TEXTURE_GLCM_ET_T2_Entropy,TEXTURE_GLCM_ET_T2_Homogeneity,TEXTURE_GLCM_ET_T2_Correlation,TEXTURE_GLCM_ET_T2_SumAverage,TEXTURE_GLCM_ET_T2_Variance,TEXTURE_GLCM_ET_T2_Dissimilarity,TEXTURE_GLCM_ET_T2_AutoCorrelation,TEXTURE_GLCM_ET_FLAIR_Energy,TEXTURE_GLCM_ET_FLAIR_Contrast,TEXTURE_GLCM_ET_FLAIR_Entropy,TEXTURE_GLCM_ET_FLAIR_Homogeneity,TEXTURE_GLCM_ET_FLAIR_Correlation,TEXTURE_GLCM_ET_FLAIR_SumAverage,TEXTURE_GLCM_ET_FLAIR_Variance,TEXTURE_GLCM_ET_FLAIR_Dissimilarity,TEXTURE_GLCM_ET_FLAIR_AutoCorrelation,TEXTURE_GLCM_ED_T1Gd_Energy,TEXTURE_GLCM_ED_T1Gd_Contrast,TEXTURE_GLCM_ED_T1Gd_Entropy,TEXTURE_GLCM_ED_T1Gd_Homogeneity,TEXTURE_GLCM_ED_T1Gd_Correlation,TEXTURE_GLCM_ED_T1Gd_SumAverage,TEXTURE_GLCM_ED_T1Gd_Variance,TEXTURE_GLCM_ED_T1Gd_Dissimilarity,TEXTURE_GLCM_ED_T1Gd_AutoCorrelation,TEXTURE_GLCM_ED_T1_Energy,TEXTURE_GLCM_ED_T1_Contrast,TEXTURE_GLCM_ED_T1_Entropy,TEXTURE_GLCM_ED_T1_Homogeneity,TEXTURE_GLCM_ED_T1_Correlation,TEXTURE_GLCM_ED_T1_SumAverage,TEXTURE_GLCM_ED_T1_Variance,TEXTURE_GLCM_ED_T1_Dissimilarity,TEXTURE_GLCM_ED_T1_AutoCorrelation,TEXTURE_GLCM_ED_T2_Energy,TEXTURE_GLCM_ED_T2_Contrast,TEXTURE_GLCM_ED_T2_Entropy,TEXTURE_GLCM_ED_T2_Homogeneity,TEXTURE_GLCM_ED_T2_Correlation,TEXTURE_GLCM_ED_T2_SumAverage,TEXTURE_GLCM_ED_T2_Variance,TEXTURE_GLCM_ED_T2_Dissimilarity,TEXTURE_GLCM_ED_T2_AutoCorrelation,TEXTURE_GLCM_ED_FLAIR_Energy,TEXTURE_GLCM_ED_FLAIR_Contrast,TEXTURE_GLCM_ED_FLAIR_Entropy,TEXTURE_GLCM_ED_FLAIR_Homogeneity,TEXTURE_GLCM_ED_FLAIR_Correlation,TEXTURE_GLCM_ED_FLAIR_SumAverage,TEXTURE_GLCM_ED_FLAIR_Variance,TEXTURE_GLCM_ED_FLAIR_Dissimilarity,TEXTURE_GLCM_ED_FLAIR_AutoCorrelation,TEXTURE_GLCM_NET_T1Gd_Energy,TEXTURE_GLCM_NET_T1Gd_Contrast,TEXTURE_GLCM_NET_T1Gd_Entropy,TEXTURE_GLCM_NET_T1Gd_Homogeneity,TEXTURE_GLCM_NET_T1Gd_Correlation,TEXTURE_GLCM_NET_T1Gd_SumAverage,TEXTURE_GLCM_NET_T1Gd_Variance,TEXTURE_GLCM_NET_T1Gd_Dissimilarity,TEXTURE_GLCM_NET_T1Gd_AutoCorrelation,TEXTURE_GLCM_NET_T1_Energy,TEXTURE_GLCM_NET_T1_Contrast,TEXTURE_GLCM_NET_T1_Entropy,TEXTURE_GLCM_NET_T1_Homogeneity,TEXTURE_GLCM_NET_T1_Correlation,TEXTURE_GLCM_NET_T1_SumAverage,TEXTURE_GLCM_NET_T1_Variance,TEXTURE_GLCM_NET_T1_Dissimilarity,TEXTURE_GLCM_NET_T1_AutoCorrelation,TEXTURE_GLCM_NET_T2_Energy,TEXTURE_GLCM_NET_T2_Contrast,TEXTURE_GLCM_NET_T2_Entropy,TEXTURE_GLCM_NET_T2_Homogeneity,TEXTURE_GLCM_NET_T2_Correlation,TEXTURE_GLCM_NET_T2_SumAverage,TEXTURE_GLCM_NET_T2_Variance,TEXTURE_GLCM_NET_T2_Dissimilarity,TEXTURE_GLCM_NET_T2_AutoCorrelation,TEXTURE_GLCM_NET_FLAIR_Energy,TEXTURE_GLCM_NET_FLAIR_Contrast,TEXTURE_GLCM_NET_FLAIR_Entropy,TEXTURE_GLCM_NET_FLAIR_Homogeneity,TEXTURE_GLCM_NET_FLAIR_Correlation,TEXTURE_GLCM_NET_FLAIR_SumAverage,TEXTURE_GLCM_NET_FLAIR_Variance,TEXTURE_GLCM_NET_FLAIR_Dissimilarity,TEXTURE_GLCM_NET_FLAIR_AutoCorrelation,TEXTURE_GLRLM_ET_T1Gd_SRE,TEXTURE_GLRLM_ET_T1Gd_LRE,TEXTURE_GLRLM_ET_T1Gd_GLN,TEXTURE_GLRLM_ET_T1Gd_RLN,TEXTURE_GLRLM_ET_T1Gd_RP,TEXTURE_GLRLM_ET_T1Gd_LGRE,TEXTURE_GLRLM_ET_T1Gd_HGRE,TEXTURE_GLRLM_ET_T1Gd_SRLGE,TEXTURE_GLRLM_ET_T1Gd_SRHGE,TEXTURE_GLRLM_ET_T1Gd_LRLGE,TEXTURE_GLRLM_ET_T1Gd_LRHGE,TEXTURE_GLRLM_ET_T1Gd_GLV,TEXTURE_GLRLM_ET_T1Gd_RLV,TEXTURE_GLRLM_ET_T1_SRE,TEXTURE_GLRLM_ET_T1_LRE,TEXTURE_GLRLM_ET_T1_GLN,TEXTURE_GLRLM_ET_T1_RLN,TEXTURE_GLRLM_ET_T1_RP,TEXTURE_GLRLM_ET_T1_LGRE,TEXTURE_GLRLM_ET_T1_HGRE,TEXTURE_GLRLM_ET_T1_SRLGE,TEXTURE_GLRLM_ET_T1_SRHGE,TEXTURE_GLRLM_ET_T1_LRLGE,TEXTURE_GLRLM_ET_T1_LRHGE,TEXTURE_GLRLM_ET_T1_GLV,TEXTURE_GLRLM_ET_T1_RLV,TEXTURE_GLRLM_ET_T2_SRE,TEXTURE_GLRLM_ET_T2_LRE,TEXTURE_GLRLM_ET_T2_GLN,TEXTURE_GLRLM_ET_T2_RLN,TEXTURE_GLRLM_ET_T2_RP,TEXTURE_GLRLM_ET_T2_LGRE,TEXTURE_GLRLM_ET_T2_HGRE,TEXTURE_GLRLM_ET_T2_SRLGE,TEXTURE_GLRLM_ET_T2_SRHGE,TEXTURE_GLRLM_ET_T2_LRLGE,TEXTURE_GLRLM_ET_T2_LRHGE,TEXTURE_GLRLM_ET_T2_GLV,TEXTURE_GLRLM_ET_T2_RLV,TEXTURE_GLRLM_ET_FLAIR_SRE,TEXTURE_GLRLM_ET_FLAIR_LRE,TEXTURE_GLRLM_ET_FLAIR_GLN,TEXTURE_GLRLM_ET_FLAIR_RLN,TEXTURE_GLRLM_ET_FLAIR_RP,TEXTURE_GLRLM_ET_FLAIR_LGRE,TEXTURE_GLRLM_ET_FLAIR_HGRE,TEXTURE_GLRLM_ET_FLAIR_SRLGE,TEXTURE_GLRLM_ET_FLAIR_SRHGE,TEXTURE_GLRLM_ET_FLAIR_LRLGE,TEXTURE_GLRLM_ET_FLAIR_LRHGE,TEXTURE_GLRLM_ET_FLAIR_GLV,TEXTURE_GLRLM_ET_FLAIR_RLV,TEXTURE_GLRLM_ED_T1Gd_SRE,TEXTURE_GLRLM_ED_T1Gd_LRE,TEXTURE_GLRLM_ED_T1Gd_GLN,TEXTURE_GLRLM_ED_T1Gd_RLN,TEXTURE_GLRLM_ED_T1Gd_RP,TEXTURE_GLRLM_ED_T1Gd_LGRE,TEXTURE_GLRLM_ED_T1Gd_HGRE,TEXTURE_GLRLM_ED_T1Gd_SRLGE,TEXTURE_GLRLM_ED_T1Gd_SRHGE,TEXTURE_GLRLM_ED_T1Gd_LRLGE,TEXTURE_GLRLM_ED_T1Gd_LRHGE,TEXTURE_GLRLM_ED_T1Gd_GLV,TEXTURE_GLRLM_ED_T1Gd_RLV,TEXTURE_GLRLM_ED_T1_SRE,TEXTURE_GLRLM_ED_T1_LRE,TEXTURE_GLRLM_ED_T1_GLN,TEXTURE_GLRLM_ED_T1_RLN,TEXTURE_GLRLM_ED_T1_RP,TEXTURE_GLRLM_ED_T1_LGRE,TEXTURE_GLRLM_ED_T1_HGRE,TEXTURE_GLRLM_ED_T1_SRLGE,TEXTURE_GLRLM_ED_T1_SRHGE,TEXTURE_GLRLM_ED_T1_LRLGE,TEXTURE_GLRLM_ED_T1_LRHGE,TEXTURE_GLRLM_ED_T1_GLV,TEXTURE_GLRLM_ED_T1_RLV,TEXTURE_GLRLM_ED_T2_SRE,TEXTURE_GLRLM_ED_T2_LRE,TEXTURE_GLRLM_ED_T2_GLN,TEXTURE_GLRLM_ED_T2_RLN,TEXTURE_GLRLM_ED_T2_RP,TEXTURE_GLRLM_ED_T2_LGRE,TEXTURE_GLRLM_ED_T2_HGRE,TEXTURE_GLRLM_ED_T2_SRLGE,TEXTURE_GLRLM_ED_T2_SRHGE,TEXTURE_GLRLM_ED_T2_LRLGE,TEXTURE_GLRLM_ED_T2_LRHGE,TEXTURE_GLRLM_ED_T2_GLV,TEXTURE_GLRLM_ED_T2_RLV,TEXTURE_GLRLM_ED_FLAIR_SRE,TEXTURE_GLRLM_ED_FLAIR_LRE,TEXTURE_GLRLM_ED_FLAIR_GLN,TEXTURE_GLRLM_ED_FLAIR_RLN,TEXTURE_GLRLM_ED_FLAIR_RP,TEXTURE_GLRLM_ED_FLAIR_LGRE,TEXTURE_GLRLM_ED_FLAIR_HGRE,TEXTURE_GLRLM_ED_FLAIR_SRLGE,TEXTURE_GLRLM_ED_FLAIR_SRHGE,TEXTURE_GLRLM_ED_FLAIR_LRLGE,TEXTURE_GLRLM_ED_FLAIR_LRHGE,TEXTURE_GLRLM_ED_FLAIR_GLV,TEXTURE_GLRLM_ED_FLAIR_RLV,TEXTURE_GLRLM_NET_T1Gd_SRE,TEXTURE_GLRLM_NET_T1Gd_LRE,TEXTURE_GLRLM_NET_T1Gd_GLN,TEXTURE_GLRLM_NET_T1Gd_RLN,TEXTURE_GLRLM_NET_T1Gd_RP,TEXTURE_GLRLM_NET_T1Gd_LGRE,TEXTURE_GLRLM_NET_T1Gd_HGRE,TEXTURE_GLRLM_NET_T1Gd_SRLGE,TEXTURE_GLRLM_NET_T1Gd_SRHGE,TEXTURE_GLRLM_NET_T1Gd_LRLGE,TEXTURE_GLRLM_NET_T1Gd_LRHGE,TEXTURE_GLRLM_NET_T1Gd_GLV,TEXTURE_GLRLM_NET_T1Gd_RLV,TEXTURE_GLRLM_NET_T1_SRE,TEXTURE_GLRLM_NET_T1_LRE,TEXTURE_GLRLM_NET_T1_GLN,TEXTURE_GLRLM_NET_T1_RLN,TEXTURE_GLRLM_NET_T1_RP,TEXTURE_GLRLM_NET_T1_LGRE,TEXTURE_GLRLM_NET_T1_HGRE,TEXTURE_GLRLM_NET_T1_SRLGE,TEXTURE_GLRLM_NET_T1_SRHGE,TEXTURE_GLRLM_NET_T1_LRLGE,TEXTURE_GLRLM_NET_T1_LRHGE,TEXTURE_GLRLM_NET_T1_GLV,TEXTURE_GLRLM_NET_T1_RLV,TEXTURE_GLRLM_NET_T2_SRE,TEXTURE_GLRLM_NET_T2_LRE,TEXTURE_GLRLM_NET_T2_GLN,TEXTURE_GLRLM_NET_T2_RLN,TEXTURE_GLRLM_NET_T2_RP,TEXTURE_GLRLM_NET_T2_LGRE,TEXTURE_GLRLM_NET_T2_HGRE,TEXTURE_GLRLM_NET_T2_SRLGE,TEXTURE_GLRLM_NET_T2_SRHGE,TEXTURE_GLRLM_NET_T2_LRLGE,TEXTURE_GLRLM_NET_T2_LRHGE,TEXTURE_GLRLM_NET_T2_GLV,TEXTURE_GLRLM_NET_T2_RLV,TEXTURE_GLRLM_NET_FLAIR_SRE,TEXTURE_GLRLM_NET_FLAIR_LRE,TEXTURE_GLRLM_NET_FLAIR_GLN,TEXTURE_GLRLM_NET_FLAIR_RLN,TEXTURE_GLRLM_NET_FLAIR_RP,TEXTURE_GLRLM_NET_FLAIR_LGRE,TEXTURE_GLRLM_NET_FLAIR_HGRE,TEXTURE_GLRLM_NET_FLAIR_SRLGE,TEXTURE_GLRLM_NET_FLAIR_SRHGE,TEXTURE_GLRLM_NET_FLAIR_LRLGE,TEXTURE_GLRLM_NET_FLAIR_LRHGE,TEXTURE_GLRLM_NET_FLAIR_GLV,TEXTURE_GLRLM_NET_FLAIR_RLV,TEXTURE_GLSZM_ET_T1Gd_SZE,TEXTURE_GLSZM_ET_T1Gd_LZE,TEXTURE_GLSZM_ET_T1Gd_GLN,TEXTURE_GLSZM_ET_T1Gd_ZSN,TEXTURE_GLSZM_ET_T1Gd_ZP,TEXTURE_GLSZM_ET_T1Gd_LGZE,TEXTURE_GLSZM_ET_T1Gd_HGZE,TEXTURE_GLSZM_ET_T1Gd_SZLGE,TEXTURE_GLSZM_ET_T1Gd_SZHGE,TEXTURE_GLSZM_ET_T1Gd_LZLGE,TEXTURE_GLSZM_ET_T1Gd_LZHGE,TEXTURE_GLSZM_ET_T1Gd_GLV,TEXTURE_GLSZM_ET_T1Gd_ZSV,TEXTURE_GLSZM_ET_T1_SZE,TEXTURE_GLSZM_ET_T1_LZE,TEXTURE_GLSZM_ET_T1_GLN,TEXTURE_GLSZM_ET_T1_ZSN,TEXTURE_GLSZM_ET_T1_ZP,TEXTURE_GLSZM_ET_T1_LGZE,TEXTURE_GLSZM_ET_T1_HGZE,TEXTURE_GLSZM_ET_T1_SZLGE,TEXTURE_GLSZM_ET_T1_SZHGE,TEXTURE_GLSZM_ET_T1_LZLGE,TEXTURE_GLSZM_ET_T1_LZHGE,TEXTURE_GLSZM_ET_T1_GLV,TEXTURE_GLSZM_ET_T1_ZSV,TEXTURE_GLSZM_ET_T2_SZE,TEXTURE_GLSZM_ET_T2_LZE,TEXTURE_GLSZM_ET_T2_GLN,TEXTURE_GLSZM_ET_T2_ZSN,TEXTURE_GLSZM_ET_T2_ZP,TEXTURE_GLSZM_ET_T2_LGZE,TEXTURE_GLSZM_ET_T2_HGZE,TEXTURE_GLSZM_ET_T2_SZLGE,TEXTURE_GLSZM_ET_T2_SZHGE,TEXTURE_GLSZM_ET_T2_LZLGE,TEXTURE_GLSZM_ET_T2_LZHGE,TEXTURE_GLSZM_ET_T2_GLV,TEXTURE_GLSZM_ET_T2_ZSV,TEXTURE_GLSZM_ET_FLAIR_SZE,TEXTURE_GLSZM_ET_FLAIR_LZE,TEXTURE_GLSZM_ET_FLAIR_GLN,TEXTURE_GLSZM_ET_FLAIR_ZSN,TEXTURE_GLSZM_ET_FLAIR_ZP,TEXTURE_GLSZM_ET_FLAIR_LGZE,TEXTURE_GLSZM_ET_FLAIR_HGZE,TEXTURE_GLSZM_ET_FLAIR_SZLGE,TEXTURE_GLSZM_ET_FLAIR_SZHGE,TEXTURE_GLSZM_ET_FLAIR_LZLGE,TEXTURE_GLSZM_ET_FLAIR_LZHGE,TEXTURE_GLSZM_ET_FLAIR_GLV,TEXTURE_GLSZM_ET_FLAIR_ZSV,TEXTURE_GLSZM_ED_T1Gd_SZE,TEXTURE_GLSZM_ED_T1Gd_LZE,TEXTURE_GLSZM_ED_T1Gd_GLN,TEXTURE_GLSZM_ED_T1Gd_ZSN,TEXTURE_GLSZM_ED_T1Gd_ZP,TEXTURE_GLSZM_ED_T1Gd_LGZE,TEXTURE_GLSZM_ED_T1Gd_HGZE,TEXTURE_GLSZM_ED_T1Gd_SZLGE,TEXTURE_GLSZM_ED_T1Gd_SZHGE,TEXTURE_GLSZM_ED_T1Gd_LZLGE,TEXTURE_GLSZM_ED_T1Gd_LZHGE,TEXTURE_GLSZM_ED_T1Gd_GLV,TEXTURE_GLSZM_ED_T1Gd_ZSV,TEXTURE_GLSZM_ED_T1_SZE,TEXTURE_GLSZM_ED_T1_LZE,TEXTURE_GLSZM_ED_T1_GLN,TEXTURE_GLSZM_ED_T1_ZSN,TEXTURE_GLSZM_ED_T1_ZP,TEXTURE_GLSZM_ED_T1_LGZE,TEXTURE_GLSZM_ED_T1_HGZE,TEXTURE_GLSZM_ED_T1_SZLGE,TEXTURE_GLSZM_ED_T1_SZHGE,TEXTURE_GLSZM_ED_T1_LZLGE,TEXTURE_GLSZM_ED_T1_LZHGE,TEXTURE_GLSZM_ED_T1_GLV,TEXTURE_GLSZM_ED_T1_ZSV,TEXTURE_GLSZM_ED_T2_SZE,TEXTURE_GLSZM_ED_T2_LZE,TEXTURE_GLSZM_ED_T2_GLN,TEXTURE_GLSZM_ED_T2_ZSN,TEXTURE_GLSZM_ED_T2_ZP,TEXTURE_GLSZM_ED_T2_LGZE,TEXTURE_GLSZM_ED_T2_HGZE,TEXTURE_GLSZM_ED_T2_SZLGE,TEXTURE_GLSZM_ED_T2_SZHGE,TEXTURE_GLSZM_ED_T2_LZLGE,TEXTURE_GLSZM_ED_T2_LZHGE,TEXTURE_GLSZM_ED_T2_GLV,TEXTURE_GLSZM_ED_T2_ZSV,TEXTURE_GLSZM_ED_FLAIR_SZE,TEXTURE_GLSZM_ED_FLAIR_LZE,TEXTURE_GLSZM_ED_FLAIR_GLN,TEXTURE_GLSZM_ED_FLAIR_ZSN,TEXTURE_GLSZM_ED_FLAIR_ZP,TEXTURE_GLSZM_ED_FLAIR_LGZE,TEXTURE_GLSZM_ED_FLAIR_HGZE,TEXTURE_GLSZM_ED_FLAIR_SZLGE,TEXTURE_GLSZM_ED_FLAIR_SZHGE,TEXTURE_GLSZM_ED_FLAIR_LZLGE,TEXTURE_GLSZM_ED_FLAIR_LZHGE,TEXTURE_GLSZM_ED_FLAIR_GLV,TEXTURE_GLSZM_ED_FLAIR_ZSV,TEXTURE_GLSZM_NET_T1Gd_SZE,TEXTURE_GLSZM_NET_T1Gd_LZE,TEXTURE_GLSZM_NET_T1Gd_GLN,TEXTURE_GLSZM_NET_T1Gd_ZSN,TEXTURE_GLSZM_NET_T1Gd_ZP,TEXTURE_GLSZM_NET_T1Gd_LGZE,TEXTURE_GLSZM_NET_T1Gd_HGZE,TEXTURE_GLSZM_NET_T1Gd_SZLGE,TEXTURE_GLSZM_NET_T1Gd_SZHGE,TEXTURE_GLSZM_NET_T1Gd_LZLGE,TEXTURE_GLSZM_NET_T1Gd_LZHGE,TEXTURE_GLSZM_NET_T1Gd_GLV,TEXTURE_GLSZM_NET_T1Gd_ZSV,TEXTURE_GLSZM_NET_T1_SZE,TEXTURE_GLSZM_NET_T1_LZE,TEXTURE_GLSZM_NET_T1_GLN,TEXTURE_GLSZM_NET_T1_ZSN,TEXTURE_GLSZM_NET_T1_ZP,TEXTURE_GLSZM_NET_T1_LGZE,TEXTURE_GLSZM_NET_T1_HGZE,TEXTURE_GLSZM_NET_T1_SZLGE,TEXTURE_GLSZM_NET_T1_SZHGE,TEXTURE_GLSZM_NET_T1_LZLGE,TEXTURE_GLSZM_NET_T1_LZHGE,TEXTURE_GLSZM_NET_T1_GLV,TEXTURE_GLSZM_NET_T1_ZSV,TEXTURE_GLSZM_NET_T2_SZE,TEXTURE_GLSZM_NET_T2_LZE,TEXTURE_GLSZM_NET_T2_GLN,TEXTURE_GLSZM_NET_T2_ZSN,TEXTURE_GLSZM_NET_T2_ZP,TEXTURE_GLSZM_NET_T2_LGZE,TEXTURE_GLSZM_NET_T2_HGZE,TEXTURE_GLSZM_NET_T2_SZLGE,TEXTURE_GLSZM_NET_T2_SZHGE,TEXTURE_GLSZM_NET_T2_LZLGE,TEXTURE_GLSZM_NET_T2_LZHGE,TEXTURE_GLSZM_NET_T2_GLV,TEXTURE_GLSZM_NET_T2_ZSV,TEXTURE_GLSZM_NET_FLAIR_SZE,TEXTURE_GLSZM_NET_FLAIR_LZE,TEXTURE_GLSZM_NET_FLAIR_GLN,TEXTURE_GLSZM_NET_FLAIR_ZSN,TEXTURE_GLSZM_NET_FLAIR_ZP,TEXTURE_GLSZM_NET_FLAIR_LGZE,TEXTURE_GLSZM_NET_FLAIR_HGZE,TEXTURE_GLSZM_NET_FLAIR_SZLGE,TEXTURE_GLSZM_NET_FLAIR_SZHGE,TEXTURE_GLSZM_NET_FLAIR_LZLGE,TEXTURE_GLSZM_NET_FLAIR_LZHGE,TEXTURE_GLSZM_NET_FLAIR_GLV,TEXTURE_GLSZM_NET_FLAIR_ZSV,TEXTURE_NGTDM_ET_T1Gd_Coarseness,TEXTURE_NGTDM_ET_T1Gd_Contrast,TEXTURE_NGTDM_ET_T1Gd_Busyness,TEXTURE_NGTDM_ET_T1Gd_Complexity,TEXTURE_NGTDM_ET_T1Gd_Strength,TEXTURE_NGTDM_ET_T1_Coarseness,TEXTURE_NGTDM_ET_T1_Contrast,TEXTURE_NGTDM_ET_T1_Busyness,TEXTURE_NGTDM_ET_T1_Complexity,TEXTURE_NGTDM_ET_T1_Strength,TEXTURE_NGTDM_ET_T2_Coarseness,TEXTURE_NGTDM_ET_T2_Contrast,TEXTURE_NGTDM_ET_T2_Busyness,TEXTURE_NGTDM_ET_T2_Complexity,TEXTURE_NGTDM_ET_T2_Strength,TEXTURE_NGTDM_ET_FLAIR_Coarseness,TEXTURE_NGTDM_ET_FLAIR_Contrast,TEXTURE_NGTDM_ET_FLAIR_Busyness,TEXTURE_NGTDM_ET_FLAIR_Complexity,TEXTURE_NGTDM_ET_FLAIR_Strength,TEXTURE_NGTDM_ED_T1Gd_Coarseness,TEXTURE_NGTDM_ED_T1Gd_Contrast,TEXTURE_NGTDM_ED_T1Gd_Busyness,TEXTURE_NGTDM_ED_T1Gd_Complexity,TEXTURE_NGTDM_ED_T1Gd_Strength,TEXTURE_NGTDM_ED_T1_Coarseness,TEXTURE_NGTDM_ED_T1_Contrast,TEXTURE_NGTDM_ED_T1_Busyness,TEXTURE_NGTDM_ED_T1_Complexity,TEXTURE_NGTDM_ED_T1_Strength,TEXTURE_NGTDM_ED_T2_Coarseness,TEXTURE_NGTDM_ED_T2_Contrast,TEXTURE_NGTDM_ED_T2_Busyness,TEXTURE_NGTDM_ED_T2_Complexity,TEXTURE_NGTDM_ED_T2_Strength,TEXTURE_NGTDM_ED_FLAIR_Coarseness,TEXTURE_NGTDM_ED_FLAIR_Contrast,TEXTURE_NGTDM_ED_FLAIR_Busyness,TEXTURE_NGTDM_ED_FLAIR_Complexity,TEXTURE_NGTDM_ED_FLAIR_Strength,TEXTURE_NGTDM_NET_T1Gd_Coarseness,TEXTURE_NGTDM_NET_T1Gd_Contrast,TEXTURE_NGTDM_NET_T1Gd_Busyness,TEXTURE_NGTDM_NET_T1Gd_Complexity,TEXTURE_NGTDM_NET_T1Gd_Strength,TEXTURE_NGTDM_NET_T1_Coarseness,TEXTURE_NGTDM_NET_T1_Contrast,TEXTURE_NGTDM_NET_T1_Busyness,TEXTURE_NGTDM_NET_T1_Complexity,TEXTURE_NGTDM_NET_T1_Strength,TEXTURE_NGTDM_NET_T2_Coarseness,TEXTURE_NGTDM_NET_T2_Contrast,TEXTURE_NGTDM_NET_T2_Busyness,TEXTURE_NGTDM_NET_T2_Complexity,TEXTURE_NGTDM_NET_T2_Strength,TEXTURE_NGTDM_NET_FLAIR_Coarseness,TEXTURE_NGTDM_NET_FLAIR_Contrast,TEXTURE_NGTDM_NET_FLAIR_Busyness,TEXTURE_NGTDM_NET_FLAIR_Complexity,TEXTURE_NGTDM_NET_FLAIR_Strength,TGM_p1,TGM_dw,TGM_Cog_X_1,TGM_Cog_Y_1,TGM_Cog_Z_1,TGM_T_1,TGM_Cog_X_2,TGM_Cog_Y_2,TGM_Cog_Z_2,TGM_T_2,TGM_Cog_X_3,TGM_Cog_Y_3,TGM_Cog_Z_3,TGM_T_3,TGM_Cog_X_4,TGM_Cog_Y_4,TGM_Cog_Z_4,TGM_T_4,TGM_Cog_X_5,TGM_Cog_Y_5,TGM_Cog_Z_5,TGM_T_5,TGM_Cog_X_6,TGM_Cog_Y_6,TGM_Cog_Z_6,TGM_T_6"
context = ""
# 打开CSV文件
with open('/root/MedSAM-main/TCGA_GBM_radiomicFeatures.csv', newline='') as csvfile:
    reader = csv.reader(csvfile)

    # 假设我们想读取第5行（索引为4，因为索引从0开始）
    for i, row in enumerate(reader):
        if row[1] == "2003.09.14":  # 读取到相应的行
            context = ",".join(row)
            break  # 找到后跳出循环

text = title + context

# 使用示例
# csv_data = "TCGA-19-5951,2003.09.14,27478..."  # 您的完整数据
vector = text_to_vector(text)
print(f"Final vector shape: {vector.shape}")
print(vector)